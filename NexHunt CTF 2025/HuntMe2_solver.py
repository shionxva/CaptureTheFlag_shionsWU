def func_00401201(param_1, param_2):
    bVar1 = param_1 ^ ((param_1 << 3) & 0xFF)
    return (bVar1 ^ (bVar1 >> 5) ^ (param_2 * 61)) & 0xFF

def calculate_byte(i):
    # The 5 strings (7 bytes each)
    strings = [
        [0xA8, 0xC5, 0x83, 0xA0, 0x42, 0x2C, 0x01],  # DAT_00402020
        [0xCB, 0x32, 0x20, 0xF3, 0xCF, 0x65, 0xBC],  # DAT_00402027
        [0x13, 0x79, 0xB2, 0x29, 0x74, 0x61, 0xE7],  # DAT_0040202E
        [0xA7, 0x68, 0x76, 0x0A, 0x4E, 0x39, 0x43],  # DAT_00402035
        [0xF1, 0xCD, 0x12, 0xB2, 0x7D, 0x0B, 0x2D],  # DAT_0040203C
    ]
    
    local_9 = 0
    for j in range(5):
        idx = (j*j + (j+1)*i + 3) % 7
        local_9 ^= strings[j][idx]
        # Rotate right by 1 bit
        local_9 = ((local_9 >> 7) | ((local_9 << 1) & 0xFF)) & 0xFF
    
    # Apply FUN_00401201
    return func_00401201(local_9, i)

# Target bytes from DAT_00402060
target_bytes = [
    0xF8, 0x98, 0x76, 0xFB, 0xC9, 0x0A, 0x03, 0x0D,
    0x44, 0x3D, 0x6B, 0xA6, 0xC3, 0x25, 0xA8, 0x60,
    0xFB, 0x57, 0x6C, 0xF3, 0xA1, 0xF0, 0xCF, 0x61,
    0xE6, 0xE4, 0x45, 0x16, 0x0E, 0x18, 0x3E, 0x27
]

# Compute the flag
flag = ""
for i in range(32):
    b = calculate_byte(i)
    flag_char = chr(target_bytes[i] ^ b)
    flag += flag_char

print("Flag:", flag)
print("Flag (hex):", "".join(f"{ord(c):02x}" for c in flag))